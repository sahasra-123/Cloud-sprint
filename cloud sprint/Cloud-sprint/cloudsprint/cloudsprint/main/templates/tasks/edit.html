<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CloudSprint - Edit Task: {{ task.title }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <header>
        <h1>CloudSprint</h1>
        <div>
            <span>Welcome, {{ session.username }}!</span>
            <a href="{{ url_for('profile') }}">Profile</a>
            <a href="{{ url_for('logout') }}">Logout</a>
        </div>
    </header>
    <nav>
        <a href="{{ url_for('dashboard') }}">Dashboard</a>
        <a href="{{ url_for('projects') }}">Projects</a>
        <a href="{{ url_for('meetings') }}">Meetings</a>
        <a href="{{ url_for('notifications') }}">Notifications</a>
        <a href="{{ url_for('chat') }}">Team Chat</a>
        {% if session.is_admin %}
            <a href="{{ url_for('admin_dashboard') }}">Admin Dashboard</a>
        {% endif %}
    </nav>
    <div class="container">
        <h2>Edit Task: {{ task.title }}</h2>
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        <form method="POST" action="{{ url_for('edit_task', task_id=task.id) }}">
            <label for="title">Title:</label>
            <input type="text" id="title" name="title" value="{{ task.title }}" required>
            
            <label for="description">Description:</label>
            <textarea id="description" name="description">{{ task.description or '' }}</textarea>
            
            <label for="status">Status:</label>
            <select id="status" name="status" required>
                <option value="Not Started" {% if task.status == 'Not Started' %}selected{% endif %}>Not Started</option>
                <option value="In Progress" {% if task.status == 'In Progress' %}selected{% endif %}>In Progress</option>
                <option value="On Hold" {% if task.status == 'On Hold' %}selected{% endif %}>On Hold</option>
                <option value="Completed" {% if task.status == 'Completed' %}selected{% endif %}>Completed</option>
            </select>
            
            <label for="deadline">Deadline:</label>
            <input type="date" id="deadline" name="deadline" value="{{ task.deadline.strftime('%Y-%m-%d') }}" required>
            
            <label for="category_id">Category:</label>
            <select id="category_id" name="category_id" required>
                {% for category in categories %}
                    <option value="{{ category.id }}" {% if category.id == task.category_id %}selected{% endif %}>{{ category.name }}</option>
                {% endfor %}
            </select>
            
            <label for="assigned_to">Assign To:</label>
            <select id="assigned_to" name="assigned_to">
                <option value="">Unassigned</option>
                {% for member in team_members %}
                    <option value="{{ member.id }}" {% if task.assigned_to and task.assigned_to.id == member.id %}selected{% endif %}>{{ member.username }}</option>
                {% endfor %}
            </select>
            
            <button type="submit">Update Task</button>
        </form>
    </div>
</body>
</html>